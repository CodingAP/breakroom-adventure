<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Breakroom Adventure Map Editor</title>
    <style>
        .edit-section {
            visibility: hidden;
        }

        .edit-section.show {
            visibility: visible;
        }
    </style>
</head>

<body>
    <input type="file" id="file-select">
    <button id="save-map">Save</button>

    <p>Edit Room?: <input type="radio" name="editor" value="edit-room" id="edit-room-radio"></p>
    <p>Edit Item?: <input type="radio" name="editor" value="edit-item" id="edit-item-radio"></p>

    <div id="edit-room-info" class="edit-section show">
        <select id="room-selection"></select>
        <button id="add-room">Add Room</button><br />
        <input type="text" id="room-name" placeholder="Room Name...">
        <input type="text" id="room-description" placeholder="Room Description...">
        <ul id="room"></ul>
    </div>

    <div id="edit-item-info" class="edit-section">

    </div>
    
    <script>
        const editRoomInfo = document.querySelector('#edit-room-info');
        const roomSelect = document.querySelector('#room-selection');
        const editItemInfo = document.querySelector('#edit-item-info');

        let rooms = [];
        let items = [];

        document.querySelector('#file-select').addEventListener('change', () => {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                
                reader.addEventListener('load', e => {
                    const content = e.target.result;
                    const json = JSON.parse(content);
                    initialize(json);
                });

                reader.readAsText(file);
            }
        });

        document.querySelector('#edit-room-radio').addEventListener('click', () => {
            editRoomInfo.classList.remove('show');
            editItemInfo.classList.remove('show');

            editRoomInfo.classList.add('show');
        });

        document.querySelector('#edit-item-radio').addEventListener('click', () => {
            editRoomInfo.classList.remove('show');
            editItemInfo.classList.remove('show');

            editItemInfo.classList.add('show');
        });

        document.querySelector('#add-room').addEventListener('click', () => {
            const newRoom = {
                name: 'New Room',
                description: 'New Room Description',
                directions: [],
                items: []
            };

            rooms.push(newRoom);

            updateSelects();
        });

        const updateSelects = () => {
            roomSelect.innerHTML = '';
            for (let i = 0; i < rooms.length; i++) {
                const option = document.createElement('option');
                option.innerHTML = rooms[i].name;
                option.value = rooms[i].id;
                roomSelect.appendChild(option);
            }
        }

        const initialize = (map) => {
            console.log(map);
        }
    </script>
</body>

</html>